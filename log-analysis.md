

### 1. What Are Logs? (Core Concept)
- Logs = **Digital footprints** or records of events/activities in systems, applications, networks, and security devices.
- They capture **who**, **what**, **when**, **where**, and **how** something happened.
- Essential for: Monitoring, Detection, Investigation, Forensics, Compliance, Threat Hunting, Incident Response.

### 2. Why Logs Matter in SOC (L1 Role)
- Detect anomalies / malicious behavior early
- Investigate alerts & incidents
- Hunt for threats proactively
- Meet regulatory requirements (GDPR, PCI-DSS, etc.)
- Correlate events across sources in SIEM
- Reconstruct attack timeline (attack chain)

### 3. Common Types of Logs (Most Important for L1 SOC)
- **System Logs** â€” OS-level events (Windows Event Logs: System, Application, Security)
- **Security Logs** â€” Authentication, privilege use, policy changes (e.g., Event ID 4624 = successful login)
- **Application Logs** â€” App-specific events/errors (e.g., IIS, SQL Server)
- **Firewall Logs** â€” Allowed/denied connections, rules triggered
- **Web Server Logs** â€” HTTP requests (access logs), errors (e.g., Apache/Nginx/IIS)
- **Authentication Logs** â€” Login success/failure (e.g., RDP, VPN, AD)
- **DNS Logs** â€” Queries/responses â†’ detect C2, data exfil, tunneling
- **Email Logs** â€” Sent/received, spam/phishing attempts
- **Proxy Logs** â€” Web browsing activity (e.g., URLs, categories, bytes transferred)
- **Cloud Logs** â€” AWS CloudTrail, Azure Activity Logs, GCP Audit Logs


### 1. System Logs (OS-Level Logs)
These record core operating system events, hardware issues, service starts/stops, driver problems, boot/shutdown, and general system health.

- **Purpose in SOC**: Detect crashes, misconfigurations, unusual reboots (potential ransomware indicator), or signs of compromise at the kernel/OS level.
- **Common Sources**:
  - Windows â†’ **System** log in Event Viewer
  - Linux â†’ `/var/log/syslog`, `/var/log/messages`, `/var/log/kern.log`
- **Examples**:
  - Windows Event ID **7045** â€” A new service was installed (attackers install malicious services).
  - Windows Event ID **6005** / **6006** â€” Event log service started/stopped (unexpected shutdowns).
  - Linux: Kernel panic or module load errors â†’ possible rootkit.
  - Unusual driver load (e.g., after-hours) â†’ driver-based persistence/rootkit.

**Red Flag**: Multiple system crashes or service failures in short time â†’ possible malware cleanup attempt.

### 2. Security Logs / Audit Logs
These track security-relevant events: authentication, authorization, policy changes, privilege use, object access (files/registry), account changes.

- **Purpose in SOC**: Primary source for detecting credential access, lateral movement, privilege escalation, persistence.
- **Common Sources**:
  - Windows â†’ **Security** log (requires auditing enabled via Group Policy)
  - Linux â†’ `/var/log/auth.log`, `/var/log/secure`
- **Key Windows Examples** (most hunted Event IDs):
  - **4624** â€” Successful logon (look at Logon Type: 3 = network, 10 = RDP, 2 = interactive).
  - **4625** â€” Failed logon (brute-force indicator if high count from one IP).
  - **4672** â€” Special privileges assigned to new logon (admins getting SeDebugPrivilege â†’ suspicious).
  - **4720** â€” User account created (new admin account = persistence).
  - **4728 / 4732** â€” User added to privileged group (Domain Admins).
  - **4740** â€” Account locked out (possible brute-force or DoS).
  - **1102** â€” Security log cleared (defense evasion â€“ attackers clear logs).

**Red Flag**: Multiple 4625 â†’ 4624 from same IP/user â†’ successful brute-force. Or 4624 with Logon Type 3 from unusual workstation.

### 3. Application Logs
Generated by specific applications/software (web servers, databases, email servers, custom apps).

- **Purpose in SOC**: Detect application-layer attacks (SQL injection, exploit attempts), errors that expose vulnerabilities, or malicious use of legit apps.
- **Common Sources**:
  - Windows â†’ **Application** log in Event Viewer
  - IIS â†’ `%SystemDrive%\inetpub\logs\LogFiles`
  - SQL Server â†’ SQL Server error logs
  - Custom apps â†’ their own log files
- **Examples**:
  - IIS: HTTP 500 errors after suspicious requests â†’ possible exploit.
  - Event ID **1000** or **1002** â€” Application crash/hang (potential exploit or malware).
  - Database: Failed login attempts or unusual queries (e.g., `xp_cmdshell` enabled).
  - PowerShell logs (if enabled): Script block logging â†’ detect obfuscated malicious scripts.

**Red Flag**: Application errors coinciding with new process creation (Event ID 4688) â†’ possible code execution via vuln.

### 4. Network Logs (Firewall, IDS/IPS, Proxy, Router/Switch)
Record traffic flows, allowed/denied connections, rules triggered.

- **Purpose in SOC**: Detect C2 communication, data exfiltration, scanning, lateral movement.
- **Common Sources**:
  - Firewalls (Palo Alto, Fortinet, Cisco ASA) â†’ traffic logs
  - Proxy (Zscaler, Blue Coat) â†’ web access logs
  - IDS/IPS (Snort, Suricata) â†’ alerts
- **Examples**:
  - Firewall: Denied inbound from external IP on port 445 â†’ SMB scanning.
  - Proxy: High volume of traffic to suspicious domain â†’ C2 beaconing.
  - Outbound to known malicious IPs (Tor exit nodes, crypto miners).
  - Large outbound transfers to unusual external IPs â†’ exfil.

**Red Flag**: Repeated small outbound connections to same domain/IP â†’ beaconing (typical Cobalt Strike / Sliver).

### 5. Endpoint / Host Logs (Advanced â€“ often with EDR/Sysmon)
Detailed activity on individual machines (process creation, file changes, network connections from endpoint).

- **Purpose in SOC**: Catch in-memory attacks, injection, living-off-the-land binaries (LOLBins).
- **Common Sources**:
  - Sysmon (very popular in modern SOCs)
  - EDR (CrowdStrike, Defender for Endpoint, Carbon Black)
- **Key Sysmon Examples**:
  - Event ID **1** â€” Process creation (command line, parent process â†’ detect suspicious rundll32.exe, powershell.exe).
  - Event ID **3** â€” Network connection (process â†’ IP/port â†’ C2).
  - Event ID **11** â€” File creation (dropped payloads in %TEMP%).
  - Event ID **13** â€” Registry value set (persistence like Run keys).

**Red Flag**: cmd.exe spawning from unusual parent (e.g., explorer.exe â†’ cmd.exe â†’ powershell.exe) â†’ typical attack chain.

### 6. Authentication / Access Logs
Focused on who accessed what (often overlaps with Security logs).

- **Examples**:
  - AD: Kerberos ticket requests (Event ID 4768/4769).
  - VPN: Successful/failed connections.
  - RDP: Logon Type 10 events.
  - Cloud: Azure AD sign-ins, AWS CloudTrail (ConsoleLogin events).

**Red Flag**: Login from impossible travel (same user logs in from India then USA in 5 minutes).

### 7. DNS Logs
Queries and responses.

- **Purpose**: Detect C2 (domain generation algorithms), phishing, data exfil via DNS tunneling.
- **Examples**:
  - Query to suspicious .top / .xyz domain.
  - High volume of TXT record queries â†’ tunneling.
  - Queries to DGA-like domains.

**Red Flag**: Thousands of failed DNS queries in short time â†’ DGA malware.

### 8. Web Server Logs (Access + Error)
HTTP requests/responses.

- **Examples**:
  - Access log: GET /admin.php?cmd=whoami â†’ web shell.
  - 404 spikes â†’ directory brute-forcing.
  - User-Agent anomalies (sqlmap, nikto scanners).

### Quick Summary Table (SOC Hunting Focus)

| Log Type              | Best For Detecting                  | Top 3 Things to Hunt For                          | Key Example Indicators                     |
|-----------------------|-------------------------------------|---------------------------------------------------|--------------------------------------------|
| Security              | Credential theft, escalation        | Failed logons, new accounts, priv changes         | 4625 spikes, 4720, 4672                    |
| System                | Persistence, rootkits               | New services, crashes, unusual reboots            | 7045, 6008                                 |
| Application           | App exploits, LOLBin abuse          | Errors + suspicious process                       | PowerShell errors, IIS 500s                |
| Network/Firewall      | C2, exfil, scanning                 | Denied traffic, outbound to bad IPs               | High denied count, beaconing               |
| Endpoint/Sysmon       | Injection, process abuse            | Suspicious parent-child, encoded commands         | Sysmon 1 with rundll32 â†’ powershell        |
| DNS                   | C2, tunneling                       | Strange domains, high failed queries              | DGA patterns, TXT heavy                    |

In real SOC work (SIEM like Splunk/Elastic/QRadar), you correlate these â€” e.g., Security 4624 + Sysmon network connection + DNS query to same IP â†’ successful compromise chain.


### 4. Log Formats (Common Ones Youâ€™ll See)
- **Syslog** â€” Standard format (RFC 5424), used by Linux/network devices (priority, facility, message)
- **JSON** â€” Structured, easy to parse (modern SIEM favorite)
- **CEF** (Common Event Format) â€” ArcSight standard, key-value pairs
- **LEF** â€” Log Event Format (some vendors)
- **Plain Text** â€” Unstructured (older apps)
- **CSV** â€” Comma-separated (exported logs)
- **Windows Event Logs** â€” .evtx binary format (use Event Viewer or PowerShell to read)

### 5. Log Management & Tools (Demo Focus: Loggly)
- **Loggly** (cloud-based log management & analytics by SolarWinds)
  - Collect logs from many sources (agents, syslog forwarding, API)
  - Search using keywords, fields, wildcards
  - Filter by time, source IP, event ID, user, etc.
  - Create **dashboards** for real-time monitoring
  - Set up **alerts** (e.g., notify on multiple failed logins)
  - Visualize trends (e.g., login spikes)


Watch previous days (1â€“10) in the playlist for foundational topics (networking, OS basics, threats, etc.). Day 11 builds toward SIEM & monitoring in later sessions.

If you want notes expanded on a specific part (e.g., more on Event IDs, Loggly queries, or comparison with Splunk/ELK), let me know! Keep grinding â€” you're on Day 11 of becoming an L1 SOC pro. ðŸ’ª
