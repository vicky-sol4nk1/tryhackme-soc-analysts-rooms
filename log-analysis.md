

### 1. What Are Logs? (Core Concept)
- Logs = **Digital footprints** or records of events/activities in systems, applications, networks, and security devices.
- They capture **who**, **what**, **when**, **where**, and **how** something happened.
- Essential for: Monitoring, Detection, Investigation, Forensics, Compliance, Threat Hunting, Incident Response.

### 2. Why Logs Matter in SOC (L1 Role)
- Detect anomalies / malicious behavior early
- Investigate alerts & incidents
- Hunt for threats proactively
- Meet regulatory requirements (GDPR, PCI-DSS, etc.)
- Correlate events across sources in SIEM
- Reconstruct attack timeline (attack chain)

### 3. Common Types of Logs (Most Important for L1 SOC)
- **System Logs** — OS-level events (Windows Event Logs: System, Application, Security)
- **Security Logs** — Authentication, privilege use, policy changes (e.g., Event ID 4624 = successful login)
- **Application Logs** — App-specific events/errors (e.g., IIS, SQL Server)
- **Firewall Logs** — Allowed/denied connections, rules triggered
- **Web Server Logs** — HTTP requests (access logs), errors (e.g., Apache/Nginx/IIS)
- **Authentication Logs** — Login success/failure (e.g., RDP, VPN, AD)
- **DNS Logs** — Queries/responses → detect C2, data exfil, tunneling
- **Email Logs** — Sent/received, spam/phishing attempts
- **Proxy Logs** — Web browsing activity (e.g., URLs, categories, bytes transferred)
- **Cloud Logs** — AWS CloudTrail, Azure Activity Logs, GCP Audit Logs


### 1. System Logs (OS-Level Logs)
These record core operating system events, hardware issues, service starts/stops, driver problems, boot/shutdown, and general system health.

- **Purpose in SOC**: Detect crashes, misconfigurations, unusual reboots (potential ransomware indicator), or signs of compromise at the kernel/OS level.
- **Common Sources**:
  - Windows → **System** log in Event Viewer
  - Linux → `/var/log/syslog`, `/var/log/messages`, `/var/log/kern.log`
- **Examples**:
  - Windows Event ID **7045** — A new service was installed (attackers install malicious services).
  - Windows Event ID **6005** / **6006** — Event log service started/stopped (unexpected shutdowns).
  - Linux: Kernel panic or module load errors → possible rootkit.
  - Unusual driver load (e.g., after-hours) → driver-based persistence/rootkit.

**Red Flag**: Multiple system crashes or service failures in short time → possible malware cleanup attempt.

### 2. Security Logs / Audit Logs
These track security-relevant events: authentication, authorization, policy changes, privilege use, object access (files/registry), account changes.

- **Purpose in SOC**: Primary source for detecting credential access, lateral movement, privilege escalation, persistence.
- **Common Sources**:
  - Windows → **Security** log (requires auditing enabled via Group Policy)
  - Linux → `/var/log/auth.log`, `/var/log/secure`
- **Key Windows Examples** (most hunted Event IDs):
  - **4624** — Successful logon (look at Logon Type: 3 = network, 10 = RDP, 2 = interactive).
  - **4625** — Failed logon (brute-force indicator if high count from one IP).
  - **4672** — Special privileges assigned to new logon (admins getting SeDebugPrivilege → suspicious).
  - **4720** — User account created (new admin account = persistence).
  - **4728 / 4732** — User added to privileged group (Domain Admins).
  - **4740** — Account locked out (possible brute-force or DoS).
  - **1102** — Security log cleared (defense evasion – attackers clear logs).

**Red Flag**: Multiple 4625 → 4624 from same IP/user → successful brute-force. Or 4624 with Logon Type 3 from unusual workstation.

### 3. Application Logs
Generated by specific applications/software (web servers, databases, email servers, custom apps).

- **Purpose in SOC**: Detect application-layer attacks (SQL injection, exploit attempts), errors that expose vulnerabilities, or malicious use of legit apps.
- **Common Sources**:
  - Windows → **Application** log in Event Viewer
  - IIS → `%SystemDrive%\inetpub\logs\LogFiles`
  - SQL Server → SQL Server error logs
  - Custom apps → their own log files
- **Examples**:
  - IIS: HTTP 500 errors after suspicious requests → possible exploit.
  - Event ID **1000** or **1002** — Application crash/hang (potential exploit or malware).
  - Database: Failed login attempts or unusual queries (e.g., `xp_cmdshell` enabled).
  - PowerShell logs (if enabled): Script block logging → detect obfuscated malicious scripts.

**Red Flag**: Application errors coinciding with new process creation (Event ID 4688) → possible code execution via vuln.

### 4. Network Logs (Firewall, IDS/IPS, Proxy, Router/Switch)
Record traffic flows, allowed/denied connections, rules triggered.

- **Purpose in SOC**: Detect C2 communication, data exfiltration, scanning, lateral movement.
- **Common Sources**:
  - Firewalls (Palo Alto, Fortinet, Cisco ASA) → traffic logs
  - Proxy (Zscaler, Blue Coat) → web access logs
  - IDS/IPS (Snort, Suricata) → alerts
- **Examples**:
  - Firewall: Denied inbound from external IP on port 445 → SMB scanning.
  - Proxy: High volume of traffic to suspicious domain → C2 beaconing.
  - Outbound to known malicious IPs (Tor exit nodes, crypto miners).
  - Large outbound transfers to unusual external IPs → exfil.

**Red Flag**: Repeated small outbound connections to same domain/IP → beaconing (typical Cobalt Strike / Sliver).

### 5. Endpoint / Host Logs (Advanced – often with EDR/Sysmon)
Detailed activity on individual machines (process creation, file changes, network connections from endpoint).

- **Purpose in SOC**: Catch in-memory attacks, injection, living-off-the-land binaries (LOLBins).
- **Common Sources**:
  - Sysmon (very popular in modern SOCs)
  - EDR (CrowdStrike, Defender for Endpoint, Carbon Black)
- **Key Sysmon Examples**:
  - Event ID **1** — Process creation (command line, parent process → detect suspicious rundll32.exe, powershell.exe).
  - Event ID **3** — Network connection (process → IP/port → C2).
  - Event ID **11** — File creation (dropped payloads in %TEMP%).
  - Event ID **13** — Registry value set (persistence like Run keys).

**Red Flag**: cmd.exe spawning from unusual parent (e.g., explorer.exe → cmd.exe → powershell.exe) → typical attack chain.

### 6. Authentication / Access Logs
Focused on who accessed what (often overlaps with Security logs).

- **Examples**:
  - AD: Kerberos ticket requests (Event ID 4768/4769).
  - VPN: Successful/failed connections.
  - RDP: Logon Type 10 events.
  - Cloud: Azure AD sign-ins, AWS CloudTrail (ConsoleLogin events).

**Red Flag**: Login from impossible travel (same user logs in from India then USA in 5 minutes).

### 7. DNS Logs
Queries and responses.

- **Purpose**: Detect C2 (domain generation algorithms), phishing, data exfil via DNS tunneling.
- **Examples**:
  - Query to suspicious .top / .xyz domain.
  - High volume of TXT record queries → tunneling.
  - Queries to DGA-like domains.

**Red Flag**: Thousands of failed DNS queries in short time → DGA malware.

### 8. Web Server Logs (Access + Error)
HTTP requests/responses.

- **Examples**:
  - Access log: GET /admin.php?cmd=whoami → web shell.
  - 404 spikes → directory brute-forcing.
  - User-Agent anomalies (sqlmap, nikto scanners).

### Quick Summary Table (SOC Hunting Focus)

| Log Type              | Best For Detecting                  | Top 3 Things to Hunt For                          | Key Example Indicators                     |
|-----------------------|-------------------------------------|---------------------------------------------------|--------------------------------------------|
| Security              | Credential theft, escalation        | Failed logons, new accounts, priv changes         | 4625 spikes, 4720, 4672                    |
| System                | Persistence, rootkits               | New services, crashes, unusual reboots            | 7045, 6008                                 |
| Application           | App exploits, LOLBin abuse          | Errors + suspicious process                       | PowerShell errors, IIS 500s                |
| Network/Firewall      | C2, exfil, scanning                 | Denied traffic, outbound to bad IPs               | High denied count, beaconing               |
| Endpoint/Sysmon       | Injection, process abuse            | Suspicious parent-child, encoded commands         | Sysmon 1 with rundll32 → powershell        |
| DNS                   | C2, tunneling                       | Strange domains, high failed queries              | DGA patterns, TXT heavy                    |

In real SOC work (SIEM like Splunk/Elastic/QRadar), you correlate these — e.g., Security 4624 + Sysmon network connection + DNS query to same IP → successful compromise chain.


### 4. Log Formats (Common Ones You’ll See)
- **Syslog** — Standard format (RFC 5424), used by Linux/network devices (priority, facility, message)
- **JSON** — Structured, easy to parse (modern SIEM favorite)
- **CEF** (Common Event Format) — ArcSight standard, key-value pairs
- **LEF** — Log Event Format (some vendors)
- **Plain Text** — Unstructured (older apps)
- **CSV** — Comma-separated (exported logs)
- **Windows Event Logs** — .evtx binary format (use Event Viewer or PowerShell to read)

### 5. Log Management & Tools (Demo Focus: Loggly)
- **Loggly** (cloud-based log management & analytics by SolarWinds)
  - Collect logs from many sources (agents, syslog forwarding, API)
  - Search using keywords, fields, wildcards
  - Filter by time, source IP, event ID, user, etc.
  - Create **dashboards** for real-time monitoring
  - Set up **alerts** (e.g., notify on multiple failed logins)
  - Visualize trends (e.g., login spikes)

 the **most common and important log fields** that SOC analysts (L1/L2) usually see and work with daily in SIEMs, EDR tools, threat hunting, and log analysis. These fields appear across different log types (Windows Event Logs, Sysmon, firewall, proxy, DNS, Syslog, CEF, JSON-normalized logs, etc.).

Not every log has **all** of these — it depends on the source and format — but modern SIEMs (Splunk, Elastic, QRadar, Sentinel, etc.) try to **normalize** them into consistent fields.

### Universal / Almost Always Present Fields (in normalized SIEM / JSON logs)

These appear in nearly every modern log source after parsing/normalization:

- **timestamp** / **@timestamp** / **UtcTime** / **EventTime** — When the event happened (usually in UTC)
- **hostname** / **host** / **computer** / **dhost** — The machine / device that generated the log
- **source_ip** / **src** / **saddr** — Source IP address
- **dest_ip** / **dst** / **daddr** — Destination IP address
- **source_port** / **sport** — Source port
- **dest_port** / **dport** — Destination port
- **protocol** / **proto** / **app** / **ApplicationProtocol** — TCP/UDP/ICMP/HTTP/etc.
- **event_id** / **EventID** / **signature_id** / **SignatureID** — Unique numeric ID for the event type (e.g., 4624, Sysmon 1)
- **event_type** / **category** / **cat** — Broad category (e.g., authentication, process, network)
- **action** / **act** / **DeviceAction** — What happened (allow, deny, create, success, failure)
- **severity** / **Severity** / **level** — 1–10 scale (info=3, warning=4, error=5–7, critical=8–10 in CEF)
- **user** / **suser** / **account_name** / **TargetUserName** — Username involved
- **log_source** / **source** / **channel** — Where it came from (Security, Sysmon/Operational, firewall, etc.)
- **message** / **msg** — Human-readable description or full raw message

### Windows-Specific Common Fields (Security + System + Application Logs)

From Event Viewer / .evtx (often parsed to XML/JSON):

- **EventRecordID** — Unique ID within the log channel
- **ProviderName** / **SourceName** — e.g., Microsoft-Windows-Security-Auditing
- **Level** — Informational, Warning, Error, Critical
- **Task** / **Opcode** — Sub-category within EventID
- **Keywords** — Bitmask flags (e.g., Audit Success/Failure)
- **LogonType** — 2=Interactive, 3=Network, 10=RDP (very important in 4624/4625)
- **AuthenticationPackageName** — NTLM, Kerberos, Negotiate
- **LogonProcessName** — Advapi, Kerberos, etc.
- **IpAddress** / **WorkstationName** — Where the logon came from
- **TargetDomainName** / **TargetUserSid** — Domain and SID of the account
- **ProcessName** / **ProcessId** — Process that triggered the event

### Sysmon-Specific High-Value Fields (Event ID 1, 3, 7, 11, 22, etc.)

Sysmon is one of the richest sources — these fields appear in **almost every** useful Sysmon event:

- **Image** / **process_path** — Full path of the executable (e.g., C:\Windows\System32\cmd.exe)
- **CommandLine** — Full arguments/command line
- **ParentImage** — Path of the parent process
- **ParentCommandLine** — Parent's full command line
- **ProcessGuid** / **ParentProcessGuid** — Unique GUID to track process lineage (better than PID)
- **ProcessId** / **ParentProcessId**
- **Hashes** — MD5,SHA1,SHA256,IMPHASH of the file
- **OriginalFileName** — PE header original name (helps detect renamed malware)
- **User** — User context under which process ran
- **IntegrityLevel** — High / Medium / Low
- **Initiated** / **Protocol** (Event ID 3) — True/False if connection initiated outbound
- **TargetFilename** (Event ID 11) — File created/modified
- **QueryName** / **QueryResults** (Event ID 22 – DNS query)

### Network / Firewall / Proxy / DNS Common Fields

- **bytes_in** / **bytes_out** / **sent** / **received** — Data volume transferred
- **packets** — Number of packets
- **duration** — Connection duration
- **url** / **http_url** / **cs-uri** — Full requested URL (proxy/web logs)
- **http_method** — GET/POST/HEAD
- **user_agent** / **cs-user-agent** — Browser/agent string
- **status_code** / **sc-status** — HTTP response code (200, 404, 500)
- **domain** / **query** — DNS queried domain
- **dns_response** / **answer** — Resolved IP(s)
- **rule** / **policy** — Firewall/proxy rule ID that matched
- **geo_country** / **src_geo** — GeoIP lookup of source IP (often enriched in SIEM)

### CEF (Common Event Format) Standard Extension Fields

Many devices send in CEF — these are the most frequently used keys in the extension part:

- **src** = source IP
- **dst** = destination IP
- **spt** = source port
- **dpt** = destination port
- **act** = action (allow/deny/block)
- **app** = application/protocol
- **cs1** / **cs2** / **cs3** ... — Custom string fields (vendor-specific)
- **cn1** / **cn2** — Custom number fields
- **msg** = message/description
- **rt** = receipt time
- **fname** = file name
- **fileHash** / **fileHashSha256** — File hashes
- **reason** — Why action was taken

### Quick Cheat Sheet – Most Hunted Fields in SOC (Daily Use)

| Priority | Field Name(s)                  | Why It's Critical                              | Common In                  |
|----------|--------------------------------|------------------------------------------------|----------------------------|
| ★★★★★    | timestamp, hostname, event_id  | Time + machine + what happened                 | All logs                   |
| ★★★★★    | src / dst IP + ports           | Network who → who                              | Network, firewall, Sysmon 3|
| ★★★★★    | user / suser / account         | Who did it                                     | Security, Sysmon           |
| ★★★★★    | Image / Process / CommandLine  | What exactly ran (with args!)                  | Sysmon 1, Process Creation |
| ★★★★☆    | ParentImage / ParentCommandLine| Attack chain / LOLBin abuse                    | Sysmon                     |
| ★★★★☆    | url / domain / query           | Web / DNS / C2 / phishing                      | Proxy, DNS, web server     |
| ★★★★☆    | action / status / result       | Success/failure/allow/deny                     | Almost all                 |
| ★★★☆☆    | hashes (SHA256, IMPHASH)       | File identity / malware matching               | Sysmon                     |
| ★★★☆☆    | bytes / packets / duration     | Exfil / beaconing volume                       | Firewall, proxy            |


